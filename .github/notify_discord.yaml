name: notify

on:
  pull_request:
    types: [opened]

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - name: Send message for pull request opened
        if: github.event_name == 'pull_request' && github.event.action == 'opened'
        uses: appleboy/discord-action@master
        with:
          webhook_url: ${{ secrets.DISCORD_WEBHOOK }}
          color: "#48f442"
          username: "GitHub Bot"
          avatar_url: "https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"
          message: |
            ğŸ‰ **Novo Pull Request Aberto!**

            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

            ğŸ“ **${{ github.event.pull_request.title }}**

            ğŸ‘¤ **Autor:** ${{ github.event.pull_request.user.login }}
            ğŸ”¢ **PR #${{ github.event.pull_request.number }}**
            ğŸ“… **Criado em:** ${{ github.event.pull_request.created_at }}

            ğŸŒ¿ **Branch:** `${{ github.event.pull_request.head.ref }}` â†’ `${{ github.event.pull_request.base.ref }}`
            ${{ github.event.pull_request.draft && 'ğŸ“ **Status:** Draft (Rascunho)' || '' }}

            ${{ github.event.pull_request.body && format('ğŸ“„ **DescriÃ§Ã£o:**\n{0}\n', github.event.pull_request.body) || '' }}

            ğŸ”— **Links:**
            â€¢ [Ver Pull Request](${{ github.event.pull_request.html_url }})
            â€¢ [Ver RepositÃ³rio](${{ github.event.repository.html_url }})
            â€¢ [Perfil do Autor](https://github.com/${{ github.event.pull_request.user.login }})

            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

      - name: Send message for pull request merged
        if: github.event_name == 'pull_request' && github.event.action == 'closed' && github.event.pull_request.merged == true
        uses: appleboy/discord-action@master
        with:
          webhook_url: ${{ secrets.DISCORD_WEBHOOK }}
          color: "#5865F2"
          username: "GitHub Bot"
          avatar_url: "https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"
          message: |
            âœ… **Pull Request Mesclado!**

            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

            ğŸ“ **${{ github.event.pull_request.title }}**

            ğŸ‘¤ **Autor:** ${{ github.event.pull_request.user.login }}
            ğŸ”¢ **PR #${{ github.event.pull_request.number }}**
            ğŸŒ¿ **Branch:** `${{ github.event.pull_request.head.ref }}` â†’ `${{ github.event.pull_request.base.ref }}`

            ğŸ”— **Links:**
            â€¢ [Ver Pull Request](${{ github.event.pull_request.html_url }})
            â€¢ [Ver RepositÃ³rio](${{ github.event.repository.html_url }})

            â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”